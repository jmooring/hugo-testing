---
type: post
date: "2020-04-02T15:00:25+02:00"
title: "Версия 2.0.0"
tags:
    - GitHub
    - InfoPi
    - Angular
    - Raspberry Pi
    - гаджеты
    - домашняя автоматизация
    - очумелые ручки
    - сделай сам
    - софт
image: "https://res.cloudinary.com/yktoo/image/upload/blog/rs1f9dcy8kkwtsdsuld3.jpg"
series: infopi
software: infopi
---

Что мы всё про коронавирус да про коронавирус? Давайте лучше о хорошем.

Я наконец-то нашёл время для радикального обновления своего информационного дисплея на базе микрокомпьютера {{< fl "Raspberry Pi" >}}, известного как [InfoPi](/software/infopi).

Об истории его создания я [рассказывал](0278) четыре года назад.

<!--more-->

## Вторая версия

Во второй инкарнации {{< fl "InfoPi" >}} переделано практически всё:

* Код переписан с {{< fl "AngularJS" >}} на {{< fl "Angular 9" >}}.
* Бэкенд (веб-сервер) на {{< fl "Python" >}} больше не требуется.
* Приложение упаковывается в единый `.deb`-пакет вместе с браузером [Electron](https://www.electronjs.org/) и разворачивается на {{< fl "Raspberry Pi" >}} одной командой.
* Изменён внешний вид.

## Внешний вид

Выглядит дисплей нынче следующим образом:

{{< imgfig "https://res.cloudinary.com/yktoo/image/upload/blog/wnaauxybvl1limkdx8mi.jpg" "Скриншот InfoPi 2.0.0." >}}

Если сравнить его с предыдущей версией:

* Показатели текущей погоды переехали вверх.
* Анимация {{< fl "Buienradar" >}} передвинута влево.
* Прогноз погоды находится справа от {{< fl "Buienradar" >}}, добавлен график температуры.
* Времена отправления поездов и автобусов отображаются бок-о-бок.
* Курсы криптовалют выкинуты как малоактуальные.
* Добавлено отображение новостей из {{< fl "RSS" >}}-потока.

Особенно удобны, на мой взгляд, новые графики максимальной и минимальной дневной температуры в прогнозе погоды (работает на [Chart.js](https://www.chartjs.org/)):

{{< imgfig "https://res.cloudinary.com/yktoo/image/upload/v1585833788/blog/hag7jpcjyxtfv7fdfjjf.jpg" "Графики дневной температуры InfoPi." >}}

Здесь отображаются предсказанные {{< fl "Buienradar" >}} границы дневной и ночной температур. При этом хорошо заметно, что чем дальше в будущем предсказание, тем шире разброс значений.

## Angular

Как известно, при переходе от первой (называвшейся {{< fl "AngularJS" >}}) к любой последующей версии {{< fl "Angular" >}} код приходится переписывать полностью. Что я и сделал.

Также я избавился от бэкенда на {{< fl "Python" >}}. Его единственной функцией был обход ограничений {{< wiki "Cross-origin_resource_sharing" "ru" "CORS" >}}-политик браузера, не позволявших веб-странице приложения запрашивать данные с других доменов (например, сайта {{< fl "NS" >}}).

В новой версии {{< fl "InfoPi" >}} во время разработки и отладки политика обходится с помощью {{< fl "CORS" >}}-прокси (такого как [CORS Anywhere](https://cors-anywhere.herokuapp.com/)). Здесь присутствует, конечно, риск того, что вы делитесь своим {{< fl "API" >}}-токеном со сторонним сервисом.

В финальной же версии приложения, исполняющейся в браузере {{< fl "Electron" >}}, {{< fl "CORS enforcement" >}} отключается в самом браузере. Поскольку {{< fl "InfoPi" >}} — система неинтерактивная, она только отображает данные, то никакого риска от несоблюдения ограничений политики здесь нет.

## Дайте две!

Если вам интересно попробовать самим собрать экземпляр устройства и настроить его под свои нужды, милости прошу в [GitHub-репозиторий](https://github.com/yktoo/infopi) приложения.

В репозитории присутствует пример конфигурации (`src/environments/config.sample.ts`), который нужно скопировать и поменять по вкусу, просто следуйте за {{< fl "README" >}}.

## В планах

Тесты, больше тестов!
