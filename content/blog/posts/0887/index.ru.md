---
type: post
date: "2024-02-12T11:05:56+01:00"
title: "3.4.0"
tags:
    - Comentario
    - веб
    - софт
    - разработка
    - релиз
    - Go
    - Angular
image: "https://res.cloudinary.com/yktoo/image/upload/v1707733008/blog/evbnsyjh49j6rsxxrbcx.jpg"
imageCredit: "Изображение: кибермозг."
series: comentario
software: comentario
---

Вот и новая версия [Comentario 3.4.0](https://gitlab.com/comentario/comentario/-/releases/v3.4.0) подоспела.

[Comentario](/software/comentario) — это быстрый и мощный свободный сервер комментариев для веб-страниц, написанный на {{< fl "Go" >}}.

{{< imgfig "https://res.cloudinary.com/yktoo/image/upload/v1707733008/blog/evbnsyjh49j6rsxxrbcx.jpg" >}}

## Что нового

Нового в этом релизе довольно много.

<!--more-->

### Обновления без перезагрузки страницы

Об [этой фиче](https://docs.comentario.app/en/kb/live-update/) просили довольно [давно](https://gitlab.com/comentario/comentario/-/issues/9).

Когда обновление включено (а включено оно по умолчанию), любые изменения в комментах на текущей странице будут появляться сразу же, без перезагрузки страницы. Это касается новых комментариев, ответов на существующие комментарии, операций удаления и голосования, а также статуса «прилеплен» ({{< fl "sticky" >}}).

{{< imgfig "https://res.cloudinary.com/yktoo/image/upload/v1707735208/blog/tlqnymgqp7rhz6tawdqn.gif" "Автозагрузка комментариев в действии." "border shadow" >}}

Реализовано автообновление при помощи [веб-сокетов](https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API), позволяющих пересылать сообщения между сервером {{< fl "Comentario" >}} и браузером в реальном времени.

Также было добавлено несколько соответствующих настроек конфигурации:

* Автообновление можно выключить на конкретной странице при помощи [атрибута](https://docs.comentario.app/en/configuration/embedding/comments-tag/) `live-update="false"`.
* Его также можно выключить вообще везде, передав ключ `--no-live-update` в [командной строке](https://docs.comentario.app/en/configuration/backend/static/).
* Максимальное количество одновременных подключений можно ограничить при помощи опции [командной строки](https://docs.comentario.app/en/configuration/backend/static/) `--ws-max-clients`. По умолчанию оно выставлено в **10 000**, чего в большинстве случаев должно быть достаточно.

### Панель инструментов редактора

Также давно просили добавить панель инструментов в редакторе комментариев. С её помощью писать комментарии в [Markdown](https://docs.comentario.app/en/kb/markdown/) заметно проще:

{{< imgfig "https://res.cloudinary.com/yktoo/image/upload/v1707736299/blog/pibra3v6kelxjjumzd8v.gif" "Панель инструментов редактора комментариев." "border shadow" >}}

Эти кнопки позволяют отформатировать текст, вставить список, таблицу, цитату и т.д.

### Предпросмотр комментариев

На гифке выше можно также заметить кнопку {{< fl "Preview" >}} (предварительный просмотр). Она появилась в версии **3.3.0**, но, поскольку я так и не сподобился выпустить об этом пост, то упоминаю здесь.

### Анонимное комментирование

Также в версии **3.3.0** чекбокс {{< fl "Comment anonymously" >}} был удалён и заменён на одноимённую кнопку в диалоге логина:

{{< imgfig "https://res.cloudinary.com/yktoo/image/upload/v1707738659/blog/lknfv4mi0ts3hqr37mlx.png" "Кнопка «Comment anonymously» в диалоге логина." >}}

Отныне не требуется отмечать этот чекбокс перед отправкой каждого комментария. После первого нажатия кнопки {{< fl "Comment anonymously" >}} в диалоге все последующие комменты будут отправляться анонимно. До тех пор, разумеется, пока вы не залогинитесь.

### Сворачивание ответов кликом по левому краю

Кнопка «Свернуть/Развернуть» была удалена, вместо неё теперь можно кликнуть по левому краю карточки с комментарием, чтобы свернуть или раскрыть его дочерние комменты (примерно как это сделано у {{< fl "Reddit" >}}):

{{< imgfig "https://res.cloudinary.com/yktoo/image/upload/v1707737052/blog/dhry9bvfgheufz37mprj.gif" "Сворачивание кликом по левому краю." "border shadow" >}}

### Опции правки и удаления

Добавлено четыре новых настройки, контролирующих редактирование и удаление комментов ([#61](https://gitlab.com/comentario/comentario/-/issues/61)):

{{< imgfig "https://res.cloudinary.com/yktoo/image/upload/v1707737589/blog/kaxvnxf50k9oi87i29fd.png" "Новые опции редактирования и удаление комментариев." >}}

### Кто удалил этот коммент?

У удалённых комментариев теперь показывается, кто это сделал: автор или модератор ([#62](https://gitlab.com/comentario/comentario/-/issues/62)).

{{< imgfig "https://res.cloudinary.com/yktoo/image/upload/v1707737843/blog/ovisaxoyas1i1cdkyeer.png" "Удалённый коммент." "border" >}}

Данную информацию не всегда удаётся отобразить — это зависит от привилегий пользователя.

### Сборки для ARM

Начиная с версии **3.4.0** стали доступны бинарные сборки для **32**- и **64**-битной [архитектуры ARM](https://docs.comentario.app/en/installation/requirements/) ([#57](https://gitlab.com/comentario/comentario/-/issues/57)).

Готовые к употреблению пакеты можно скачать без регистрации и СМС на [странице релизов](https://gitlab.com/comentario/comentario/-/releases).

### Прочие изменения

#### Вышло в 3.4.0

* Админка: исправлено отображение анонимного юзера
* Админка: обычные пользователи могут удалять свои комменты
* Админка: в свойствах коммента отображается, кто и когда отмодерировал и удалил его
* Исправлено: цитаты в {{< fl "Markdown" >}}
* Исправлено: зачёркнутый текст в {{< fl "Markdown" >}}
* Операции домена: очистка домена также сбрасывает счётчики просмотров и комментариев ([#55](https://gitlab.com/comentario/comentario/-/issues/55))
* Встраиваемые комментарии: новые иконки
* Встраиваемые комментарии: предупреждение, если у домена нет доступных способов аутентификации

#### Вышло в 3.3.0

* Встраиваемые комментарии: настройки сортировки и анонимного комментирования теперь сохраняются локально
* Встраиваемые комментарии: сортировка комментов по рейтингу в возрастающем порядке
* Встраиваемые комментарии: сортировка по рейтингу скрывается, когда голосование запрещено ([#48](https://gitlab.com/comentario/comentario/-/issues/48))
* Встраиваемые комментарии: кнопка редактирования профиля скрывается для {{< fl "SSO" >}}-пользователей ([#45](https://gitlab.com/comentario/comentario/-/issues/45))
* Новые настройки динамической конфигурации, определяющие возможность регистрации комментаторов ([#47](https://gitlab.com/comentario/comentario/-/issues/47))

## Демо-версия

Увидеть новую версию в действии, а также её административный интерфейс (логин с емэйлом `admin@admin` и паролем `admin`), можно на демо-сайте:

{{< button "https://demo.comentario.app/" "Демо-сайт комментариев" "btn-primary mb-3" >}}
{{< button "https://edge.comentario.app/" "Демо админки Comentario" "btn-primary mb-3" >}}

## Установка

Если вы хотите установить {{< fl "Comentario" >}}, вот ссылки на документацию:

* [Getting started](https://docs.comentario.app/en/getting-started/).
* [Installation](https://docs.comentario.app/en/installation/).
* [Migration](https://docs.comentario.app/en/installation/migration/).
